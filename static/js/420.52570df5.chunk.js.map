{"version":3,"file":"static/js/420.52570df5.chunk.js","mappings":"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","sources":["components/ui/Card.js","components/Comments.js","components/AnnotationPopup.js","pages/ArticleViewPage.js"],"sourcesContent":["import React from 'react';\r\n\r\nconst Card = ({ children, className = '' }) => (\r\n    <div className={`bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ${className}`}>{children}</div>\r\n);\r\n\r\nexport default Card;","import React, { useState, useMemo, useEffect } from 'react';\r\nimport { Link, useLocation } from 'react-router-dom';\r\nimport Button from './ui/Button';\r\nimport { ReplyIcon, TrashIcon } from '../assets/icons';\r\n\r\nconst Comment = ({ comment, onReply, onDelete, profile }) => {\r\n    const [showReplyForm, setShowReplyForm] = useState(false);\r\n    const [replyContent, setReplyContent] = useState('');\r\n\r\n    const handleReplySubmit = (e) => {\r\n        e.preventDefault();\r\n        if (!replyContent.trim()) return;\r\n        onReply(replyContent, comment.id);\r\n        setReplyContent('');\r\n        setShowReplyForm(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col gap-2 p-3 rounded-lg bg-white shadow-sm\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 rounded-full bg-orange-200 flex items-center justify-center font-bold text-orange-600\">\r\n                        {comment.profiles.first_name?.[0] || 'U'}\r\n                    </div>\r\n                    <span className=\"font-semibold text-gray-800\">{comment.profiles.first_name} {comment.profiles.last_name}</span>\r\n                </div>\r\n                <span className=\"text-xs text-gray-400\">{new Date(comment.created_at).toLocaleString()}</span>\r\n            </div>\r\n            <p className=\"text-gray-700 pl-10\">{comment.content}</p>\r\n            <div className=\"flex items-center justify-end gap-2 pl-10\">\r\n                {profile && <Button variant=\"secondary\" size=\"sm\" onClick={() => setShowReplyForm(!showReplyForm)}><ReplyIcon /> Cavab ver</Button>}\r\n                {profile?.id === comment.user_id && <Button variant=\"danger\" size=\"sm\" onClick={() => onDelete(comment.id)}><TrashIcon /></Button>}\r\n            </div>\r\n            {showReplyForm && (\r\n                <form onSubmit={handleReplySubmit} className=\"pl-10 mt-2 flex gap-2\">\r\n                    <input \r\n                        type=\"text\" \r\n                        value={replyContent}\r\n                        onChange={(e) => setReplyContent(e.target.value)}\r\n                        placeholder={`Cavab verilir: ${comment.profiles.first_name}...`}\r\n                        className=\"flex-grow mt-1 block w-full rounded-md border-gray-300 shadow-sm text-sm\"\r\n                    />\r\n                    <Button type=\"submit\" size=\"sm\">Göndər</Button>\r\n                </form>\r\n            )}\r\n            {comment.children && comment.children.length > 0 && (\r\n                <div className=\"pl-6 border-l-2 border-orange-100 mt-2 space-y-3\">\r\n                    {comment.children.map(child => (\r\n                        <Comment key={child.id} comment={child} onReply={onReply} onDelete={onDelete} profile={profile} />\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Comments = ({ targetId, targetType, profile, fetchComments, postComment, deleteComment }) => {\r\n    const [comments, setComments] = useState([]);\r\n    const [newComment, setNewComment] = useState('');\r\n    const location = useLocation();\r\n\r\n    useEffect(() => {\r\n        const loadComments = async () => {\r\n            const fetchedComments = await fetchComments(targetId, targetType);\r\n            setComments(fetchedComments || []);\r\n        };\r\n        if (targetId && targetType) {\r\n            loadComments();\r\n        }\r\n    }, [targetId, targetType, fetchComments]);\r\n\r\n    const handlePostComment = async (content, parentId = null) => {\r\n        const targetUrl = `${location.pathname}#comment-${parentId || 'new'}`;\r\n        const postedComment = await postComment(targetId, targetType, content, parentId, targetUrl);\r\n        if (postedComment) {\r\n            const fetchedComments = await fetchComments(targetId, targetType);\r\n            setComments(fetchedComments || []);\r\n            if (!parentId) {\r\n                setNewComment('');\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleDeleteComment = async (commentId) => {\r\n        const success = await deleteComment(commentId);\r\n        if (success) {\r\n            setComments(prev => prev.filter(c => c.id !== commentId));\r\n        }\r\n    };\r\n\r\n    const commentTree = useMemo(() => {\r\n        const map = {};\r\n        const roots = [];\r\n        comments.forEach(comment => {\r\n            map[comment.id] = { ...comment, children: [] };\r\n        });\r\n        comments.forEach(comment => {\r\n            if (comment.parent_comment_id && map[comment.parent_comment_id]) {\r\n                map[comment.parent_comment_id].children.push(map[comment.id]);\r\n            } else {\r\n                roots.push(map[comment.id]);\r\n            }\r\n        });\r\n        return roots;\r\n    }, [comments]);\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <h3 className=\"text-xl font-bold text-gray-800\">Şərhlər ({comments.length})</h3>\r\n            {profile && (\r\n                <form onSubmit={(e) => { e.preventDefault(); handlePostComment(newComment); }} className=\"flex gap-2 items-start\">\r\n                    <textarea \r\n                        value={newComment}\r\n                        onChange={(e) => setNewComment(e.target.value)}\r\n                        placeholder=\"Şərhinizi yazın...\"\r\n                        className=\"flex-grow mt-1 block w-full rounded-md border-gray-300 shadow-sm\"\r\n                        rows=\"3\"\r\n                    />\r\n                    <Button type=\"submit\">Göndər</Button>\r\n                </form>\r\n            )}\r\n            {!profile && <p className=\"text-center p-4 bg-gray-50 rounded-md\">Şərh yazmaq üçün <Link to=\"/auth\" className=\"text-orange-600 font-semibold hover:underline\">daxil olun</Link>.</p>}\r\n            \r\n            <div className=\"space-y-4\">\r\n                {commentTree.map(comment => (\r\n                    <Comment key={comment.id} comment={comment} onReply={handlePostComment} onDelete={handleDeleteComment} profile={profile} />\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Comments;\r\n","import React, { useState, useEffect, useRef } from 'react';\nimport Button from './ui/Button';\nimport { TrashIcon } from '../assets/icons';\n\nconst AnnotationPopup = ({ x, y, annotation, onSave, onDelete, onClose, className = '' }) => {\n    const [note, setNote] = useState('');\n    const ref = useRef(null);\n\n    useEffect(() => {\n        setNote(annotation?.note_content || '');\n    }, [annotation]);\n\n    const handleSave = () => {\n        onSave(note);\n    };\n\n    const handleDelete = () => {\n        if (window.confirm('Bu annotasiyanı silmək istədiyinizə əminsiniz?')) {\n            onDelete(annotation.id);\n            onClose();\n        }\n    };\n\n    return (\n        <div\n            ref={ref}\n            className={`absolute z-20 w-80 bg-white rounded-lg shadow-xl p-4 border border-gray-200 ${className}`}\n            style={{ left: `${x}px`, top: `${y}px` }}\n        >\n            <h4 className=\"font-bold text-gray-800 mb-2\">Şəxsi Qeyd</h4>\n            <textarea\n                value={note}\n                onChange={(e) => setNote(e.target.value)}\n                placeholder=\"Bura qeydinizi yazın...\"\n                className=\"w-full p-2 border border-gray-300 rounded-md text-sm\"\n                rows=\"4\"\n                autoFocus\n            />\n            <div className=\"flex justify-between items-center mt-3\">\n                {annotation?.id && (\n                    <Button onClick={handleDelete} variant=\"danger\" size=\"sm\">\n                        <TrashIcon />\n                    </Button>\n                )}\n                <div className=\"flex-grow\" />\n                <Button onClick={handleSave} size=\"sm\">\n                    Yadda saxla\n                </Button>\n            </div>\n        </div>\n    );\n};\n\nexport default AnnotationPopup;","import React, { useMemo, useEffect, useRef, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport DOMPurify from 'dompurify';\nimport Card from '../components/ui/Card';\nimport { useOnClickOutside } from 'usehooks-ts';\nimport Button from '../components/ui/Button';\nimport { ArrowLeftIcon, PlayIcon, CheckCircleIcon, PencilSquareIcon } from '../assets/icons';\nimport Comments from '../components/Comments'; \nimport AnnotationPopup from '../components/AnnotationPopup';\n\nconst ArticleStyles = () => (\n    <style>{`\n        .article-content h1, .article-content h2, .article-content h3, .article-content h4 {\n            margin-bottom: 0.75em !important;\n            margin-top: 1.5em !important;\n            font-weight: 700 !important;\n            line-height: 1.3 !important;\n        }\n        .article-content h1 { font-size: 2.25em !important; !important; /* red-600 */ }\n        .article-content h2 { font-size: 1.875em !important; !important; /* blue-600 */ }\n        .article-content h3 { font-size: 1.5em !important; !important; /* green-600 */ }\n        .article-content p {\n            margin-bottom: 1.25em !important;\n            line-height: 1.7 !important;\n            color: #374151 !important; /* gray-700 */\n        }\n        .article-content ul, .article-content ol {\n            margin-left: 1.5em !important;\n            margin-bottom: 1.25em !important;\n            padding-left: 1.5em !important;\n        }\n        .article-content ul { list-style-type: disc !important; }\n        .article-content ol { list-style-type: decimal !important; }\n        .article-content li { margin-bottom: 0.5em !important; }\n        .article-content table {\n            width: 100% !important;\n            border-collapse: collapse !important;\n            margin-bottom: 1.5em !important;\n            border: 1px solid #e5e7eb !important; /* gray-200 */\n        }\n        .article-content th, .article-content td {\n            border: 1px solid #e5e7eb !important; /* gray-200 */\n            padding: 0.75em 1em !important;\n            text-align: left !important;\n        }\n        .article-content th {\n            background-color: #f9fafb !important; /* gray-50 */\n            font-weight: 600 !important;\n        }\n        .article-content a {\n            color: #ea580c !important; /* orange-600 */\n            text-decoration: underline !important;\n        }\n        .article-content strong { font-weight: 700 !important; }\n        .article-content em { font-style: italic !important; }\n        .article-content blockquote {\n            border-left: 4px solid #f97316 !important; /* orange-500 */\n            padding-left: 1em !important;\n            margin-left: 0 !important;\n            font-style: italic !important;\n            color: #4b5563 !important; /* gray-600 */\n        }\n        .highlighted-annotation {\n            background-color: rgba(253, 230, 138, 0.5) !important; /* yellow-300 with 50% opacity */\n            cursor: pointer;\n            position: relative;\n        }\n        .highlighted-annotation:hover {\n            background-color: rgba(252, 211, 77, 0.6) !important; /* yellow-400 with 60% opacity */\n        }\n    `}</style>\n);\n\nconst ArticleViewPage = ({ articles, quizzes, onStartQuiz, onMarkAsRead, articleProgress, profile, fetchComments, postComment, deleteComment, userAnnotations, onSaveAnnotation, onDeleteAnnotation }) => {\n    const { articleId } = useParams();\n    const navigate = useNavigate();\n    const articleContentRef = useRef(null); \n    const [popupState, setPopupState] = useState({ stage: 'hidden', x: 0, y: 0, selection: null, existingAnnotation: null });\n\n    const articleAnnotations = useMemo(() => (userAnnotations || []).filter(a => a.article_id === Number(articleId)), [userAnnotations, articleId]);\n\n    const article = useMemo(() => {\n        if (!articles || !quizzes) return null;\n        const currentArticle = articles.find(a => a.id === Number(articleId));\n        if (!currentArticle) return null;\n\n        const attachedQuizIds = new Set((currentArticle.article_quizzes || []).map(aq => aq.quiz_id));\n        const attachedQuizzes = quizzes.filter(q => attachedQuizIds.has(q.id));\n\n        return { ...currentArticle, quizzes: attachedQuizzes };\n    }, [articles, quizzes, articleId]);\n\n    const isCompleted = useMemo(() => {\n        return articleProgress.some(p => p.article_id === Number(articleId));\n    }, [articleProgress, articleId]);\n\n    const annotatedContent = useMemo(() => {\n        let content = article?.content || '';\n        if (articleAnnotations.length > 0) {\n            articleAnnotations.forEach(annotation => {\n                // Use a regular expression to replace all occurrences of the highlighted text\n                // This is a simplified approach. A more robust solution might need to handle HTML tags within the text.\n                const highlightedHtml = `<mark class=\"highlighted-annotation\" data-annotation-id=\"${annotation.id}\">${annotation.highlighted_text}</mark>`;\n                // Escape special characters for regex\n                const escapedText = annotation.highlighted_text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                content = content.replace(new RegExp(escapedText, 'g'), highlightedHtml);\n            });\n        }\n        return DOMPurify.sanitize(content);\n    }, [article?.content, articleAnnotations]);\n\n    useEffect(() => {\n        const contentNode = articleContentRef.current;\n        if (!contentNode) return;\n\n        const handleMouseUp = (e) => {\n            // Don't trigger a new annotation if clicking on an existing one\n            if (e.target.closest('.annotation-trigger-container')) {\n                return;\n            }\n\n            // Don't trigger a new annotation if clicking on an existing one\n            if (e.target.closest('.highlighted-annotation')) {\n                return;\n            }\n\n            const selection = window.getSelection();\n            const selectedText = selection.toString().trim();\n\n            if (selectedText.length > 0 && contentNode.contains(selection.anchorNode)) {\n                const range = selection.getRangeAt(0);\n                const rect = range.getBoundingClientRect();\n                setPopupState({\n                    stage: 'trigger',\n                    x: rect.left + window.scrollX,\n                    y: rect.top + window.scrollY - 40, // Position above selection\n                    selection: { text: selectedText, range },\n                    existingAnnotation: null\n                });\n            } else {\n                if (!e.target.closest('.annotation-popup-container')) { setPopupState({ stage: 'hidden' }); }\n            }\n        };\n\n        const handleHighlightClick = (e) => {\n            const highlightElement = e.target.closest('.highlighted-annotation');\n            if (highlightElement) {\n                const annotationId = highlightElement.dataset.annotationId;\n                const annotation = articleAnnotations.find(a => a.id === Number(annotationId));\n                if (annotation) {\n                    const rect = highlightElement.getBoundingClientRect(); \n                    setPopupState({\n                        stage: 'editor',\n                        x: rect.left + window.scrollX,\n                        y: rect.top + window.scrollY - 40,\n                        selection: null,\n                        existingAnnotation: annotation\n                    });\n                }\n            }\n        };\n\n        document.addEventListener('mouseup', handleMouseUp);\n        contentNode.addEventListener('click', handleHighlightClick);\n\n        return () => {\n            document.removeEventListener('mouseup', handleMouseUp);\n            contentNode.removeEventListener('click', handleHighlightClick);\n        };\n    }, [articleAnnotations]); // Re-bind events if annotations change\n\n\n\n    const handleSaveAnnotation = (noteContent) => { \n        const data = popupState.existingAnnotation\n            ? { ...popupState.existingAnnotation, note_content: noteContent }\n            : { article_id: article.id, highlighted_text: popupState.selection.text, note_content: noteContent };\n        onSaveAnnotation(data);\n        setPopupState({ stage: 'hidden' });\n    };\n\n    if (!article) {\n        return <Card><p className=\"text-center\">Məqalə tapılmadı.</p></Card>;\n    }\n\n    const AnnotationTrigger = ({ x, y, onClick, onClose }) => {\n        const ref = useRef(null);\n        useOnClickOutside(ref, onClose);\n        return (\n            <div ref={ref} className=\"absolute z-20 annotation-trigger-container\" style={{ left: `${x}px`, top: `${y}px` }}>\n                <Button onClick={onClick} size=\"sm\">\n                    <PencilSquareIcon /> Qeyd əlavə et\n                </Button>\n            </div>\n        );\n    };\n\n    return (\n        <>\n            <ArticleStyles /> \n            {popupState.stage === 'trigger' && (\n                <AnnotationTrigger\n                    x={popupState.x}\n                    y={popupState.y}\n                    onClick={() => setPopupState(prev => ({ ...prev, stage: 'editor' }))}\n                    onClose={() => setPopupState({ stage: 'hidden' })}\n                />\n            )}\n            {popupState.stage === 'editor' && (\n                <AnnotationPopup\n                    x={popupState.x}\n                    y={popupState.y}\n                    annotation={popupState.existingAnnotation}\n                    onSave={handleSaveAnnotation}\n                    onDelete={onDeleteAnnotation}\n                    onClose={() => setPopupState({ stage: 'hidden' })}\n                    className=\"annotation-popup-container\"\n                />\n            )}\n            <div className=\"animate-fade-in max-w-4xl mx-auto space-y-6\">\n                <div className=\"flex justify-between items-center\">\n                    <Button variant=\"secondary\" onClick={() => navigate('/articles')}><ArrowLeftIcon /> Məqalələr siyahısına qayıt</Button>\n                    {isCompleted ? (\n                        <span className=\"flex items-center font-semibold text-green-600\"><CheckCircleIcon className=\"w-6 h-6 mr-2\" /> Oxunub</span>\n                    ) : (\n                        <Button onClick={() => onMarkAsRead(article.id)}>Oxunmuş kimi işarələ</Button>\n                    )}\n                </div>\n                <Card>\n                    <h1 className=\"text-3xl font-bold text-gray-800 mb-4\">{article.title}</h1>\n                    <div ref={articleContentRef} className=\"article-content\" dangerouslySetInnerHTML={{ __html: annotatedContent }} />\n                    <div className=\"mt-6 pt-6 border-t\">\n                        <Comments\n                            targetId={article.id}\n                            targetType=\"article\"\n                            profile={profile}\n                            fetchComments={fetchComments}\n                            postComment={postComment}\n                            deleteComment={deleteComment}\n                        />\n                    </div>\n                </Card>\n\n                {article.quizzes && article.quizzes.length > 0 && (\n                    <Card>\n                        <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Mövzuya aid testlər</h2>\n                        <div className=\"space-y-3\">\n                            {article.quizzes.map(quiz => (\n                                <div key={quiz.id} className=\"flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50\">\n                                    <div>\n                                        <h3 className=\"font-semibold text-lg\">{quiz.title}</h3>\n                                        <p className=\"text-sm text-gray-500\">{quiz.questions.length} sual</p>\n                                    </div>\n                                    <Button onClick={() => onStartQuiz(quiz.id)}><PlayIcon /> Testə Başla</Button>\n                                </div>\n                            ))}\n                        </div>\n                    </Card>\n                )}\n            </div>\n        </>\n    );\n};\n\nexport default ArticleViewPage;\n"],"names":["_ref","children","className","_jsx","concat","Comment","_comment$profiles$fir","comment","onReply","onDelete","profile","showReplyForm","setShowReplyForm","useState","replyContent","setReplyContent","_jsxs","profiles","first_name","last_name","Date","created_at","toLocaleString","content","Button","variant","size","onClick","ReplyIcon","id","user_id","TrashIcon","onSubmit","e","preventDefault","trim","type","value","onChange","target","placeholder","length","map","child","_ref2","targetId","targetType","fetchComments","postComment","deleteComment","comments","setComments","newComment","setNewComment","location","useLocation","useEffect","async","fetchedComments","loadComments","handlePostComment","parentId","arguments","undefined","targetUrl","pathname","handleDeleteComment","commentId","prev","filter","c","commentTree","useMemo","roots","forEach","_objectSpread","parent_comment_id","push","rows","Link","to","x","y","annotation","onSave","onClose","note","setNote","ref","useRef","note_content","style","left","top","autoFocus","handleDelete","window","confirm","handleSave","ArticleStyles","articles","quizzes","onStartQuiz","onMarkAsRead","articleProgress","userAnnotations","onSaveAnnotation","onDeleteAnnotation","articleId","useParams","navigate","useNavigate","articleContentRef","popupState","setPopupState","stage","selection","existingAnnotation","articleAnnotations","a","article_id","Number","article","currentArticle","find","attachedQuizIds","Set","article_quizzes","aq","quiz_id","attachedQuizzes","q","has","isCompleted","some","p","annotatedContent","highlightedHtml","highlighted_text","escapedText","replace","RegExp","DOMPurify","sanitize","contentNode","current","handleMouseUp","closest","getSelection","selectedText","toString","contains","anchorNode","range","getRangeAt","rect","getBoundingClientRect","scrollX","scrollY","text","handleHighlightClick","highlightElement","annotationId","dataset","document","addEventListener","removeEventListener","Card","AnnotationTrigger","useOnClickOutside","PencilSquareIcon","_Fragment","AnnotationPopup","noteContent","data","ArrowLeftIcon","CheckCircleIcon","title","dangerouslySetInnerHTML","__html","Comments","quiz","questions","PlayIcon"],"sourceRoot":""}