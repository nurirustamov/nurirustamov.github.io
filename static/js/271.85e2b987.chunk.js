"use strict";(self.webpackChunkquiztest=self.webpackChunkquiztest||[]).push([[271],{7271:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var r=t(9379),a=t(5043),l=t(5475),n=t(3216),i=t(8132),c=t(4450),d=t(1425),o=t(3918),x=t(6058),m=t(7304),u=t(579);m.t1.register(m.PP,m.kc,m.E8,m.hE,m.m_,m.s$);const h=(e,s)=>{if(void 0===s||null===s)return!1;if(!e||!e.type)return!1;if("open"===e.type)return(null===s||void 0===s?void 0:s.score)>0;if("single"===e.type)return s===e.options[e.correctAnswers[0]];if("multiple"===e.type){const t=e.correctAnswers.map(s=>e.options[s]).sort(),r=s?[...s].sort():[];return JSON.stringify(t)===JSON.stringify(r)}return"textInput"===e.type?s&&e.correctAnswers[0].trim().toLowerCase()===s.trim().toLowerCase():"trueFalse"===e.type?s===e.correctAnswer:"ordering"===e.type&&JSON.stringify(s)===JSON.stringify(e.orderItems)},g=e=>{let{isOpen:s,onClose:t,question:n,results:i}=e;const c=(0,a.useMemo)(()=>{if(!n||!i)return{correct:[],incorrect:[]};const e=[],s=[];return i.forEach(t=>{const a={id:t.user_id,name:"".concat(t.userName," ").concat(t.userSurname)},l=t.userAnswers[n.id];var i;h(n,l)?e.push(a):s.push((0,r.A)((0,r.A)({},a),{},{answer:(i=l,null===i||void 0===i?"Cavab yoxdur":Array.isArray(i)?i.join(", "):"object"===typeof i?i.answer||"N/A":String(i))}))}),{correct:e,incorrect:s}},[n,i]);return s?(0,u.jsx)(d.A,{isOpen:s,onClose:t,title:'Suala cavab ver\u0259nl\u0259r: "'.concat(n.text,'"'),size:"lg",children:(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h4",{className:"font-bold text-green-600 mb-2 flex items-center gap-2",children:[(0,u.jsx)(o.C1,{})," D\xfczg\xfcn cavab ver\u0259nl\u0259r (",c.correct.length,")"]}),(0,u.jsx)("div",{className:"max-h-64 overflow-y-auto bg-green-50 p-3 rounded-lg",children:c.correct.length>0?(0,u.jsx)("ul",{className:"space-y-2",children:c.correct.map(e=>(0,u.jsx)("li",{children:(0,u.jsx)(l.N_,{to:"/student/".concat(e.id),className:"text-blue-600 hover:underline",children:e.name})},e.id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Yoxdur"})})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("h4",{className:"font-bold text-red-600 mb-2 flex items-center gap-2",children:[(0,u.jsx)(o.qh,{})," S\u0259hv cavab ver\u0259nl\u0259r (",c.incorrect.length,")"]}),(0,u.jsx)("div",{className:"max-h-64 overflow-y-auto bg-red-50 p-3 rounded-lg",children:c.incorrect.length>0?(0,u.jsx)("ul",{className:"space-y-2",children:c.incorrect.map(e=>(0,u.jsxs)("li",{children:[(0,u.jsx)(l.N_,{to:"/student/".concat(e.id),className:"text-blue-600 hover:underline",children:e.name}),(0,u.jsxs)("p",{className:"text-xs text-gray-600 pl-2 border-l-2 border-red-200 ml-2 mt-1",children:["Cavab: ",(0,u.jsx)("span",{className:"font-medium text-red-700",children:e.answer})]})]},e.id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Yoxdur"})})]})]})}):null},p=e=>{let{quizzes:s,results:t,allUsers:d,studentGroups:m}=e;const{quizId:p}=(0,n.g)(),[j,b]=(0,a.useState)(null),[f,N]=(0,a.useState)("all"),[v,y]=(0,a.useState)("all"),A=(0,a.useMemo)(()=>s.find(e=>e.id===Number(p)),[s,p]),w=(0,a.useMemo)(()=>{let e=t.filter(e=>e.quizId===Number(p)&&"pending_review"!==e.status);if("all"!==f){const s=m.find(e=>e.id===Number(f));if(s){const t=new Set((s.members||[]).map(e=>e.user_id));e=e.filter(e=>t.has(e.user_id))}}return e},[t,p,f,m]),S=(0,a.useMemo)(()=>{if(!A||0===w.length)return null;const e=w.length,s=w.reduce((e,s)=>e+s.percentage,0)/e,t=Math.max(...w.map(e=>e.percentage)),a=Math.min(...w.map(e=>e.percentage)),l=Array(10).fill(0);w.forEach(e=>{const s=Math.floor(e.percentage/10);10===s?l[9]++:l[s]++});const n=(A.questions||[]).map(s=>{let t=0;w.forEach(e=>{h(s,e.userAnswers[s.id])&&t++});let a=0,l=0,n=0,i=0,c=0,d=0;return w.forEach(e=>{var t;const r=null===(t=e.time_per_question)||void 0===t?void 0:t[s.id];void 0!==r&&(a+=r,l++,h(s,e.userAnswers[s.id])?(n+=r,i++):(c+=r,d++))}),(0,r.A)((0,r.A)({},s),{},{correctPercentage:t/e*100,averageTime:l>0?a/l:0,averageTimeCorrect:i>0?n/i:0,averageTimeIncorrect:d>0?c/d:0})});return{totalAttempts:e,averageScore:s,highestScore:t,lowestScore:a,scoreDistribution:l,questionAnalysis:n}},[A,w]),_=(0,a.useMemo)(()=>{if(!w||!d)return[];const e={};return w.forEach(s=>{(!e[s.user_id]||s.score>e[s.user_id].score)&&(e[s.user_id]={score:s.score,percentage:s.percentage,user_id:s.user_id})}),Object.values(e).sort((e,s)=>s.score-e.score).slice(0,10).map(e=>{const s=d.find(s=>s.id===e.user_id);return(0,r.A)((0,r.A)({},e),{},{name:s?"".concat(s.first_name||""," ").concat(s.last_name||"").trim():"Nam\u0259lum istifad\u0259\xe7i"})})},[w,d]),C=(0,a.useMemo)(()=>S&&S.questionAnalysis?[...S.questionAnalysis].filter(e=>e.averageTime>0).sort((e,s)=>s.averageTime-e.averageTime).slice(0,5):[],[S]),q=(0,a.useMemo)(()=>{if(!w)return[];const e=new Map;return w.forEach(s=>{e.has(s.user_id)||e.set(s.user_id,{id:s.user_id,name:"".concat(s.userName," ").concat(s.userSurname)})}),Array.from(e.values())},[w]),k=(0,a.useMemo)(()=>{if("all"===v||!w)return null;const e=w.filter(e=>e.user_id===v).sort((e,s)=>new Date(s.created_at)-new Date(e.created_at))[0];return e&&e.time_per_question?Object.entries(e.time_per_question).map(e=>{let[s,t]=e;const r=A.questions.find(e=>e.id===Number(s));return{id:s,text:(null===r||void 0===r?void 0:r.text)||"Nam\u0259lum sual",timeSpent:t}}).filter(e=>"Nam\u0259lum sual"!==e.text).sort((e,s)=>s.timeSpent-e.timeSpent).slice(0,5):[]},[v,w,A]);if(!A)return(0,u.jsx)(i.A,{children:(0,u.jsx)("p",{className:"text-center",children:"Test tap\u0131lmad\u0131."})});if(!S)return(0,u.jsxs)(i.A,{className:"text-center py-12",children:[(0,u.jsx)("p",{className:"text-gray-500 mb-6 text-lg",children:"all"!==f?"Se\xe7ilmi\u015f qrup \xfc\xe7\xfcn bu testd\u0259 he\xe7 bir n\u0259tic\u0259 tap\u0131lmad\u0131.":"Bu test \xfc\xe7\xfcn he\xe7 bir n\u0259tic\u0259 tap\u0131lmad\u0131."}),"all"!==f?(0,u.jsxs)(c.A,{variant:"secondary",onClick:()=>{N("all"),y("all")},children:[(0,u.jsx)(o.A6,{})," Filtri s\u0131f\u0131rla"]}):(0,u.jsx)(l.N_,{to:"/stats",children:(0,u.jsxs)(c.A,{variant:"secondary",children:[(0,u.jsx)(o.A6,{})," Statistikaya qay\u0131t"]})})]});const T={labels:["0-9%","10-19%","20-29%","30-39%","40-49%","50-59%","60-69%","70-79%","80-89%","90-100%"],datasets:[{label:"T\u0259l\u0259b\u0259 say\u0131",data:S.scoreDistribution,backgroundColor:"rgba(249, 115, 22, 0.6)",borderColor:"rgba(249, 115, 22, 1)",borderWidth:1}]};return(0,u.jsxs)("div",{className:"animate-fade-in space-y-6",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Test Analizi"}),(0,u.jsx)("p",{className:"text-lg text-gray-600",children:A.title})]}),(0,u.jsx)(l.N_,{to:"/stats",children:(0,u.jsxs)(c.A,{variant:"secondary",children:[(0,u.jsx)(o.A6,{})," Statistikaya qay\u0131t"]})})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,u.jsxs)(i.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"C\u0259hdl\u0259r"}),(0,u.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:S.totalAttempts})]}),(0,u.jsxs)(i.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"Orta N\u0259tic\u0259"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-blue-600",children:[S.averageScore.toFixed(1),"%"]})]}),(0,u.jsxs)(i.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"\u018fn Y\xfcks\u0259k"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:[S.highestScore,"%"]})]}),(0,u.jsxs)(i.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"\u018fn A\u015fa\u011f\u0131"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:[S.lowestScore,"%"]})]})]}),(0,u.jsxs)(i.A,{children:[(0,u.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,u.jsx)(o.OR,{})," Bu Test \xfczr\u0259 Liderl\u0259r"]}),_.length>0?(0,u.jsx)("ol",{className:"space-y-2",children:_.map((e,s)=>(0,u.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-gray-50",children:[(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)("span",{className:"font-bold text-gray-400 w-6 text-center",children:s+1}),(0,u.jsxs)("span",{className:"flex items-center gap-2",children:[0===s?(0,u.jsx)(o.b8,{}):1===s?(0,u.jsx)(o.SZ,{}):2===s?(0,u.jsx)(o.BC,{}):(0,u.jsx)(o.OR,{className:"w-5 h-5 text-gray-400"}),(0,u.jsx)(l.N_,{to:"/student/".concat(e.user_id),className:"font-semibold text-blue-600 hover:underline",children:e.name})]})]}),(0,u.jsxs)("span",{className:"font-bold text-orange-500",children:[e.score," bal (",e.percentage,"%)"]})]},e.user_id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Bu test \xfc\xe7\xfcn reytinq m\u0259lumat\u0131 yoxdur."})]}),(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"N\u0259tic\u0259l\u0259rin Paylanmas\u0131"}),(0,u.jsx)("div",{className:"h-80",children:(0,u.jsx)(x.yP,{data:T,options:{maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})]}),(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Filtrl\u0259r"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"group-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Qrup se\xe7in"}),(0,u.jsxs)("select",{id:"group-select",value:f,onChange:e=>{N(e.target.value),y("all")},className:"w-full p-2 border border-gray-300 rounded-md bg-white focus:ring-orange-500 focus:border-orange-500",children:[(0,u.jsx)("option",{value:"all",children:"B\xfct\xfcn Qruplar"}),(m||[]).map(e=>(0,u.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"student-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"T\u0259l\u0259b\u0259 se\xe7in"}),(0,u.jsxs)("select",{id:"student-select",value:v,onChange:e=>y(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-white focus:ring-orange-500 focus:border-orange-500",children:[(0,u.jsx)("option",{value:"all",children:"B\xfct\xfcn t\u0259l\u0259b\u0259l\u0259r (\xfcmumi)"}),q.map(e=>(0,u.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"\u018fn \xc7\u0259tin Suallar (\u0259n az d\xfczg\xfcn cavab)"}),(0,u.jsx)("ul",{className:"list-inside space-y-2",children:S.questionAnalysis.filter(e=>e.correctPercentage<100).sort((e,s)=>e.correctPercentage-s.correctPercentage).slice(0,5).map(e=>(0,u.jsxs)("li",{children:[(0,u.jsxs)("button",{onClick:()=>b(e),className:"text-left text-blue-600 hover:underline flex items-center gap-2",children:[(0,u.jsx)(o.r9,{}),(0,u.jsx)("strong",{children:e.text})]})," - ",(0,u.jsxs)("span",{className:"text-red-600",children:[e.correctPercentage.toFixed(1),"% d\xfczg\xfcn"]})]},e.id))})]}),(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"\u018fn \xc7ox Vaxt Aparan Suallar"}),C.length>0?(0,u.jsx)("ul",{className:"list-inside space-y-2",children:C.map(e=>(0,u.jsxs)("li",{children:[(0,u.jsxs)("button",{onClick:()=>b(e),className:"text-left text-blue-600 hover:underline flex items-center gap-2",children:[(0,u.jsx)(o.O4,{}),(0,u.jsx)("strong",{children:e.text})]})," - ",(0,u.jsxs)("span",{className:"text-purple-600",children:[e.averageTime.toFixed(1)," san. (orta)"]})]},e.id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Vaxt m\u0259lumat\u0131 tap\u0131lmad\u0131."})]})]}),k&&k.length>0&&(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Se\xe7ilmi\u015f T\u0259l\u0259b\u0259 \xfc\xe7\xfcn \u018fn \xc7ox Vaxt Aparan Suallar"}),(0,u.jsx)("ul",{className:"list-inside space-y-2",children:k.map(e=>(0,u.jsxs)("li",{children:[(0,u.jsxs)("button",{onClick:()=>b(S.questionAnalysis.find(s=>s.id===Number(e.id))),className:"text-left text-blue-600 hover:underline flex items-center gap-2",children:[(0,u.jsx)(o.O4,{}),(0,u.jsx)("strong",{children:e.text})]})," - ",(0,u.jsxs)("span",{className:"text-purple-600",children:[e.timeSpent.toFixed(1)," san."]})]},e.id))})]}),(0,u.jsxs)(i.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Suallar\u0131n Analizi"}),(0,u.jsx)("div",{className:"space-y-2",children:S.questionAnalysis.map((e,s)=>(0,u.jsxs)("button",{onClick:()=>b(e),className:"w-full text-left p-4 rounded-lg bg-gray-50 hover:bg-orange-50 transition",children:[(0,u.jsxs)("p",{className:"font-semibold",children:[s+1,". ",e.text]}),(0,u.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,u.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4",children:(0,u.jsx)("div",{className:"h-4 rounded-full transition-all duration-500",style:{width:"".concat(e.correctPercentage,"%"),backgroundColor:e.correctPercentage>60?"#22C55E":e.correctPercentage>30?"#F59E0B":"#EF4444"}})}),(0,u.jsxs)("span",{className:"font-bold text-sm w-16 text-right",style:{color:e.correctPercentage>60?"#16A34A":e.correctPercentage>30?"#D97706":"#DC2626"},children:[e.correctPercentage.toFixed(1),"%"]})]}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"d\xfczg\xfcn cavab verdi"}),e.averageTime>0&&(0,u.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-600 space-y-1",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Orta s\u0259rf olunan vaxt:"})," ",e.averageTime.toFixed(1)," san."]}),e.averageTimeCorrect>0&&(0,u.jsxs)("p",{className:"text-green-600",children:[(0,u.jsx)("strong",{children:"D\xfczg\xfcn cavab \xfc\xe7\xfcn orta vaxt:"})," ",e.averageTimeCorrect.toFixed(1)," san."]}),e.averageTimeIncorrect>0&&(0,u.jsxs)("p",{className:"text-red-600",children:[(0,u.jsx)("strong",{children:"S\u0259hv cavab \xfc\xe7\xfcn orta vaxt:"})," ",e.averageTimeIncorrect.toFixed(1)," san."]})]})]},e.id))})]}),(0,u.jsx)(g,{isOpen:!!j,onClose:()=>b(null),question:j,results:w})]})}},8132:(e,s,t)=>{t.d(s,{A:()=>a});t(5043);var r=t(579);const a=e=>{let{children:s,className:t=""}=e;return(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ".concat(t),children:s})}}}]);
//# sourceMappingURL=271.85e2b987.chunk.js.map