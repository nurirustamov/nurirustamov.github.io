{"version":3,"file":"static/js/645.e78b233e.chunk.js","mappings":"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","sources":["components/ui/Card.js","pages/FlashcardStudyPage.js"],"sourcesContent":["import React from 'react';\n\nconst Card = ({ children, className = '' }) => (\n    <div className={`bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ${className}`}>{children}</div>\n);\n\nexport default Card;","import React, { useState, useMemo, useEffect } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport Card from '../components/ui/Card';\nimport Button from '../components/ui/Button';\nimport { ArrowLeftIcon, CheckCircleIcon } from '../assets/icons';\n\n// --- Animation Styles ---\nconst AnimationStyles = () => (\n    <style>{`\n        @keyframes fadeIn {\n            from { opacity: 0; transform: scale(0.95); }\n            to { opacity: 1; transform: scale(1); }\n        }\n        @keyframes slideOut {\n            from { opacity: 1; transform: translateX(0); }\n            to { opacity: 0; transform: translateX(-100%); }\n        }\n        @keyframes slideIn {\n            from { opacity: 0; transform: translateX(100%); }\n            to { opacity: 1; transform: translateX(0); }\n        }\n        .flashcard-enter { animation: slideIn 0.3s ease-out forwards; }\n        .flashcard-exit { animation: slideOut 0.3s ease-in forwards; }\n        .flashcard-reveal { animation: fadeIn 0.3s ease-in-out forwards; }\n    `}</style>\n);\n\n// --- SM-2 Algorithm ---\nconst calculateSpacedRepetition = (review, quality) => {\n    let { repetitions, ease_factor, interval } = review;\n    if (quality < 3) {\n        repetitions = 0;\n        interval = 1;\n    } else {\n        if (repetitions === 0) interval = 1;\n        else if (repetitions === 1) interval = 6;\n        else interval = Math.round(interval * ease_factor);\n        repetitions += 1;\n    }\n    ease_factor = ease_factor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));\n    if (ease_factor < 1.3) ease_factor = 1.3;\n    const next_review_at = new Date();\n    next_review_at.setDate(next_review_at.getDate() + interval);\n    return { ...review, repetitions, ease_factor: parseFloat(ease_factor.toFixed(2)), interval, next_review_at: next_review_at.toISOString() };\n};\n\n// --- Main Component ---\nconst FlashcardStudyPage = ({ decks, userReviews, onUpdateReview }) => {\n    const { deckId } = useParams();\n    const [studySession, setStudySession] = useState({ cards: [], currentCardIndex: 0 });\n    const [cardToRender, setCardToRender] = useState(null);\n    const [isFlipped, setIsFlipped] = useState(false);\n    const [animationClass, setAnimationClass] = useState('flashcard-enter');\n    const [isSessionLoading, setIsSessionLoading] = useState(true);\n\n    const deck = useMemo(() => decks.find(d => d.id === Number(deckId)), [decks, deckId]);\n\n    useEffect(() => {\n        if (!deck) return;\n        const now = new Date().toISOString();\n        const allCards = deck.flashcards || [];\n        const dueReviews = (userReviews || []).filter(review => allCards.some(c => c.id === review.card_id) && review.next_review_at <= now);\n        const newCards = allCards.filter(card => !(userReviews || []).some(review => review.card_id === card.id));\n        const dueCardIds = new Set(dueReviews.map(r => r.card_id));\n        const dueCardsFromReviews = allCards.filter(c => dueCardIds.has(c.id));\n        const cardsToStudy = [...newCards, ...dueCardsFromReviews].sort(() => Math.random() - 0.5);\n\n        setStudySession({ cards: cardsToStudy, currentCardIndex: 0 });\n        if (cardsToStudy.length > 0) {\n            setCardToRender(cardsToStudy[0]);\n        }\n        setIsSessionLoading(false);\n    }, [deck, userReviews]);\n\n    const handleFlip = () => {\n        setIsFlipped(true);\n    };\n\n    const goToNextCard = () => {\n        setAnimationClass('flashcard-exit');\n        setTimeout(() => {\n            setStudySession(prev => {\n                const nextIndex = prev.currentCardIndex + 1;\n                if (prev.cards[nextIndex]) {\n                    setCardToRender(prev.cards[nextIndex]);\n                }\n                return { ...prev, currentCardIndex: nextIndex };\n            });\n            setIsFlipped(false);\n            setAnimationClass('flashcard-enter');\n        }, 300); // Match animation duration\n    };\n\n    const handleGrade = (quality) => {\n        const currentCardForGrading = studySession.cards[studySession.currentCardIndex];\n        const review = (userReviews || []).find(r => r.card_id === currentCardForGrading.id) || { card_id: currentCardForGrading.id, repetitions: 0, ease_factor: 2.5, interval: 0 };\n        const updatedReview = calculateSpacedRepetition(review, quality);\n        onUpdateReview(updatedReview);\n        goToNextCard();\n    };\n\n    if (isSessionLoading) return <Card className=\"text-center py-12\">Təkrar sessiyası hazırlanır...</Card>;\n    if (!deck) return <Card className=\"text-center py-12\">Koloda tapılmadı.</Card>;\n\n    const isSessionDone = studySession.currentCardIndex >= studySession.cards.length;\n\n    if (isSessionDone) {\n        return (\n            <Card className=\"text-center py-12 animate-fade-in\">\n                <CheckCircleIcon className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n                <h2 className=\"text-2xl font-bold text-gray-800\">Sessiya Tamamlandı!</h2>\n                <p className=\"text-gray-600 mt-2\">Bu gün üçün bütün təkrarları bitirdiniz. Afərin!</p>\n                <Link to=\"/decks\"><Button className=\"mt-6\"><ArrowLeftIcon /> Bütün kolodalara qayıt</Button></Link>\n            </Card>\n        );\n    }\n\n    const progressPercentage = (studySession.currentCardIndex / studySession.cards.length) * 100;\n\n    if (!cardToRender) {\n        return <Card className=\"text-center py-12\">Yüklənir...</Card>;\n    }\n\n    return (\n        <>\n            <AnimationStyles />\n            <div className=\"animate-fade-in max-w-2xl mx-auto\">\n                <div className=\"mb-4\">\n                    <Link to=\"/decks\"><Button variant=\"secondary\"><ArrowLeftIcon /> Kolodalara qayıt</Button></Link>\n                </div>\n                <Card>\n                    <div className=\"mb-4\">\n                        <div className=\"flex justify-between items-center mb-1\">\n                            <span className=\"text-sm font-semibold text-gray-600\">{deck.title}</span>\n                            <span className=\"text-sm font-semibold text-gray-600\">{studySession.currentCardIndex + 1} / {studySession.cards.length}</span>\n                        </div>\n                        <div className=\"w-full bg-gray-200 rounded-full h-2\"><div className=\"bg-orange-500 h-2 rounded-full\" style={{ width: `${progressPercentage}%` }}></div></div>\n                    </div>\n\n                    <div className={`w-full h-64 rounded-lg flex items-center justify-center p-6 text-center ${animationClass}`}>\n                        {!isFlipped ? (\n                            <p className=\"text-xl font-semibold text-gray-800\">{cardToRender.front}</p>\n                        ) : (\n                            <p className=\"text-xl font-semibold text-gray-800\">{cardToRender.back}</p>\n                        )}\n                    </div>\n\n                    <div className=\"mt-6\">\n                        {!isFlipped ? (\n                            <Button onClick={handleFlip} className=\"w-full\">Cavabı Göstər</Button>\n                        ) : (\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                                <Button onClick={() => handleGrade(0)} variant=\"danger\">Yenidən</Button>\n                                <Button onClick={() => handleGrade(2)} className=\"bg-yellow-500 hover:bg-yellow-600 text-white\">Çətin</Button>\n                                <Button onClick={() => handleGrade(4)} className=\"bg-green-500 hover:bg-green-600 text-white\">Yaxşı</Button>\n                                <Button onClick={() => handleGrade(5)} className=\"bg-blue-500 hover:bg-blue-600 text-white\">Asan</Button>\n                            </div>\n                        )}\n                    </div>\n                </Card>\n            </div>\n        </>\n    );\n};\n\nexport default FlashcardStudyPage;\n"],"names":["_ref","children","className","_jsx","concat","AnimationStyles","decks","userReviews","onUpdateReview","deckId","useParams","studySession","setStudySession","useState","cards","currentCardIndex","cardToRender","setCardToRender","isFlipped","setIsFlipped","animationClass","setAnimationClass","isSessionLoading","setIsSessionLoading","deck","useMemo","find","d","id","Number","useEffect","now","Date","toISOString","allCards","flashcards","dueReviews","filter","review","some","c","card_id","next_review_at","newCards","card","dueCardIds","Set","map","r","cardsToStudy","has","sort","Math","random","length","handleGrade","quality","currentCardForGrading","updatedReview","calculateSpacedRepetition","repetitions","ease_factor","interval","round","setDate","getDate","_objectSpread","parseFloat","toFixed","setTimeout","prev","nextIndex","Card","_jsxs","CheckCircleIcon","Link","to","Button","ArrowLeftIcon","progressPercentage","_Fragment","variant","title","style","width","back","front","onClick","handleFlip"],"sourceRoot":""}