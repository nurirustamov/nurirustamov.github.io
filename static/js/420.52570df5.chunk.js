"use strict";(self.webpackChunkquiztest=self.webpackChunkquiztest||[]).push([[420],{8132:(e,t,n)=>{n.d(t,{A:()=>a});n(5043);var i=n(579);const a=e=>{let{children:t,className:n=""}=e;return(0,i.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ".concat(n),children:t})}},9207:(e,t,n)=>{n.d(t,{A:()=>m});var i=n(9379),a=n(5043),o=n(3216),s=n(5475),r=n(4450),l=n(3918),c=n(579);const d=e=>{var t;let{comment:n,onReply:i,onDelete:o,profile:s}=e;const[m,h]=(0,a.useState)(!1),[g,x]=(0,a.useState)("");return(0,c.jsxs)("div",{className:"flex flex-col gap-2 p-3 rounded-lg bg-white shadow-sm",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-orange-200 flex items-center justify-center font-bold text-orange-600",children:(null===(t=n.profiles.first_name)||void 0===t?void 0:t[0])||"U"}),(0,c.jsxs)("span",{className:"font-semibold text-gray-800",children:[n.profiles.first_name," ",n.profiles.last_name]})]}),(0,c.jsx)("span",{className:"text-xs text-gray-400",children:new Date(n.created_at).toLocaleString()})]}),(0,c.jsx)("p",{className:"text-gray-700 pl-10",children:n.content}),(0,c.jsxs)("div",{className:"flex items-center justify-end gap-2 pl-10",children:[s&&(0,c.jsxs)(r.A,{variant:"secondary",size:"sm",onClick:()=>h(!m),children:[(0,c.jsx)(l.Sb,{})," Cavab ver"]}),(null===s||void 0===s?void 0:s.id)===n.user_id&&(0,c.jsx)(r.A,{variant:"danger",size:"sm",onClick:()=>o(n.id),children:(0,c.jsx)(l.uc,{})})]}),m&&(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),g.trim()&&(i(g,n.id),x(""),h(!1))},className:"pl-10 mt-2 flex gap-2",children:[(0,c.jsx)("input",{type:"text",value:g,onChange:e=>x(e.target.value),placeholder:"Cavab verilir: ".concat(n.profiles.first_name,"..."),className:"flex-grow mt-1 block w-full rounded-md border-gray-300 shadow-sm text-sm"}),(0,c.jsx)(r.A,{type:"submit",size:"sm",children:"G\xf6nd\u0259r"})]}),n.children&&n.children.length>0&&(0,c.jsx)("div",{className:"pl-6 border-l-2 border-orange-100 mt-2 space-y-3",children:n.children.map(e=>(0,c.jsx)(d,{comment:e,onReply:i,onDelete:o,profile:s},e.id))})]})},m=e=>{let{targetId:t,targetType:n,profile:l,fetchComments:m,postComment:h,deleteComment:g}=e;const[x,u]=(0,a.useState)([]),[p,f]=(0,a.useState)(""),y=(0,o.zy)();(0,a.useEffect)(()=>{t&&n&&(async()=>{const e=await m(t,n);u(e||[])})()},[t,n,m]);const b=async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a="".concat(y.pathname,"#comment-").concat(i||"new");if(await h(t,n,e,i,a)){const e=await m(t,n);u(e||[]),i||f("")}},j=async e=>{await g(e)&&u(t=>t.filter(t=>t.id!==e))},v=(0,a.useMemo)(()=>{const e={},t=[];return x.forEach(t=>{e[t.id]=(0,i.A)((0,i.A)({},t),{},{children:[]})}),x.forEach(n=>{n.parent_comment_id&&e[n.parent_comment_id]?e[n.parent_comment_id].children.push(e[n.id]):t.push(e[n.id])}),t},[x]);return(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("h3",{className:"text-xl font-bold text-gray-800",children:["\u015e\u0259rhl\u0259r (",x.length,")"]}),l&&(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b(p)},className:"flex gap-2 items-start",children:[(0,c.jsx)("textarea",{value:p,onChange:e=>f(e.target.value),placeholder:"\u015e\u0259rhinizi yaz\u0131n...",className:"flex-grow mt-1 block w-full rounded-md border-gray-300 shadow-sm",rows:"3"}),(0,c.jsx)(r.A,{type:"submit",children:"G\xf6nd\u0259r"})]}),!l&&(0,c.jsxs)("p",{className:"text-center p-4 bg-gray-50 rounded-md",children:["\u015e\u0259rh yazmaq \xfc\xe7\xfcn ",(0,c.jsx)(s.N_,{to:"/auth",className:"text-orange-600 font-semibold hover:underline",children:"daxil olun"}),"."]}),(0,c.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,c.jsx)(d,{comment:e,onReply:b,onDelete:j,profile:l},e.id))})]})}},9420:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var i=n(9379),a=n(5043),o=n(3216),s=n(7977),r=n(8132),l=n(4483),c=n(4450),d=n(3918),m=n(9207),h=n(579);const g=e=>{let{x:t,y:n,annotation:i,onSave:o,onDelete:s,onClose:r,className:l=""}=e;const[m,g]=(0,a.useState)(""),x=(0,a.useRef)(null);(0,a.useEffect)(()=>{g((null===i||void 0===i?void 0:i.note_content)||"")},[i]);return(0,h.jsxs)("div",{ref:x,className:"absolute z-20 w-80 bg-white rounded-lg shadow-xl p-4 border border-gray-200 ".concat(l),style:{left:"".concat(t,"px"),top:"".concat(n,"px")},children:[(0,h.jsx)("h4",{className:"font-bold text-gray-800 mb-2",children:"\u015e\u0259xsi Qeyd"}),(0,h.jsx)("textarea",{value:m,onChange:e=>g(e.target.value),placeholder:"Bura qeydinizi yaz\u0131n...",className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:"4",autoFocus:!0}),(0,h.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(null===i||void 0===i?void 0:i.id)&&(0,h.jsx)(c.A,{onClick:()=>{window.confirm("Bu annotasiyan\u0131 silm\u0259k ist\u0259diyiniz\u0259 \u0259minsiniz?")&&(s(i.id),r())},variant:"danger",size:"sm",children:(0,h.jsx)(d.uc,{})}),(0,h.jsx)("div",{className:"flex-grow"}),(0,h.jsx)(c.A,{onClick:()=>{o(m)},size:"sm",children:"Yadda saxla"})]})]})},x=()=>(0,h.jsx)("style",{children:"\n        .article-content h1, .article-content h2, .article-content h3, .article-content h4 {\n            margin-bottom: 0.75em !important;\n            margin-top: 1.5em !important;\n            font-weight: 700 !important;\n            line-height: 1.3 !important;\n        }\n        .article-content h1 { font-size: 2.25em !important; !important; /* red-600 */ }\n        .article-content h2 { font-size: 1.875em !important; !important; /* blue-600 */ }\n        .article-content h3 { font-size: 1.5em !important; !important; /* green-600 */ }\n        .article-content p {\n            margin-bottom: 1.25em !important;\n            line-height: 1.7 !important;\n            color: #374151 !important; /* gray-700 */\n        }\n        .article-content ul, .article-content ol {\n            margin-left: 1.5em !important;\n            margin-bottom: 1.25em !important;\n            padding-left: 1.5em !important;\n        }\n        .article-content ul { list-style-type: disc !important; }\n        .article-content ol { list-style-type: decimal !important; }\n        .article-content li { margin-bottom: 0.5em !important; }\n        .article-content table {\n            width: 100% !important;\n            border-collapse: collapse !important;\n            margin-bottom: 1.5em !important;\n            border: 1px solid #e5e7eb !important; /* gray-200 */\n        }\n        .article-content th, .article-content td {\n            border: 1px solid #e5e7eb !important; /* gray-200 */\n            padding: 0.75em 1em !important;\n            text-align: left !important;\n        }\n        .article-content th {\n            background-color: #f9fafb !important; /* gray-50 */\n            font-weight: 600 !important;\n        }\n        .article-content a {\n            color: #ea580c !important; /* orange-600 */\n            text-decoration: underline !important;\n        }\n        .article-content strong { font-weight: 700 !important; }\n        .article-content em { font-style: italic !important; }\n        .article-content blockquote {\n            border-left: 4px solid #f97316 !important; /* orange-500 */\n            padding-left: 1em !important;\n            margin-left: 0 !important;\n            font-style: italic !important;\n            color: #4b5563 !important; /* gray-600 */\n        }\n        .highlighted-annotation {\n            background-color: rgba(253, 230, 138, 0.5) !important; /* yellow-300 with 50% opacity */\n            cursor: pointer;\n            position: relative;\n        }\n        .highlighted-annotation:hover {\n            background-color: rgba(252, 211, 77, 0.6) !important; /* yellow-400 with 60% opacity */\n        }\n    "}),u=e=>{let{articles:t,quizzes:n,onStartQuiz:u,onMarkAsRead:p,articleProgress:f,profile:y,fetchComments:b,postComment:j,deleteComment:v,userAnnotations:w,onSaveAnnotation:N,onDeleteAnnotation:z}=e;const{articleId:A}=(0,o.g)(),C=(0,o.Zp)(),k=(0,a.useRef)(null),[_,S]=(0,a.useState)({stage:"hidden",x:0,y:0,selection:null,existingAnnotation:null}),q=(0,a.useMemo)(()=>(w||[]).filter(e=>e.article_id===Number(A)),[w,A]),E=(0,a.useMemo)(()=>{if(!t||!n)return null;const e=t.find(e=>e.id===Number(A));if(!e)return null;const a=new Set((e.article_quizzes||[]).map(e=>e.quiz_id)),o=n.filter(e=>a.has(e.id));return(0,i.A)((0,i.A)({},e),{},{quizzes:o})},[t,n,A]),R=(0,a.useMemo)(()=>f.some(e=>e.article_id===Number(A)),[f,A]),M=(0,a.useMemo)(()=>{let e=(null===E||void 0===E?void 0:E.content)||"";return q.length>0&&q.forEach(t=>{const n='<mark class="highlighted-annotation" data-annotation-id="'.concat(t.id,'">').concat(t.highlighted_text,"</mark>"),i=t.highlighted_text.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp(i,"g"),n)}),s.default.sanitize(e)},[null===E||void 0===E?void 0:E.content,q]);(0,a.useEffect)(()=>{const e=k.current;if(!e)return;const t=t=>{if(t.target.closest(".annotation-trigger-container"))return;if(t.target.closest(".highlighted-annotation"))return;const n=window.getSelection(),i=n.toString().trim();if(i.length>0&&e.contains(n.anchorNode)){const e=n.getRangeAt(0),t=e.getBoundingClientRect();S({stage:"trigger",x:t.left+window.scrollX,y:t.top+window.scrollY-40,selection:{text:i,range:e},existingAnnotation:null})}else t.target.closest(".annotation-popup-container")||S({stage:"hidden"})},n=e=>{const t=e.target.closest(".highlighted-annotation");if(t){const e=t.dataset.annotationId,n=q.find(t=>t.id===Number(e));if(n){const e=t.getBoundingClientRect();S({stage:"editor",x:e.left+window.scrollX,y:e.top+window.scrollY-40,selection:null,existingAnnotation:n})}}};return document.addEventListener("mouseup",t),e.addEventListener("click",n),()=>{document.removeEventListener("mouseup",t),e.removeEventListener("click",n)}},[q]);if(!E)return(0,h.jsx)(r.A,{children:(0,h.jsx)("p",{className:"text-center",children:"M\u0259qal\u0259 tap\u0131lmad\u0131."})});const D=e=>{let{x:t,y:n,onClick:i,onClose:o}=e;const s=(0,a.useRef)(null);return(0,l.Wr)(s,o),(0,h.jsx)("div",{ref:s,className:"absolute z-20 annotation-trigger-container",style:{left:"".concat(t,"px"),top:"".concat(n,"px")},children:(0,h.jsxs)(c.A,{onClick:i,size:"sm",children:[(0,h.jsx)(d.ab,{})," Qeyd \u0259lav\u0259 et"]})})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x,{}),"trigger"===_.stage&&(0,h.jsx)(D,{x:_.x,y:_.y,onClick:()=>S(e=>(0,i.A)((0,i.A)({},e),{},{stage:"editor"})),onClose:()=>S({stage:"hidden"})}),"editor"===_.stage&&(0,h.jsx)(g,{x:_.x,y:_.y,annotation:_.existingAnnotation,onSave:e=>{const t=_.existingAnnotation?(0,i.A)((0,i.A)({},_.existingAnnotation),{},{note_content:e}):{article_id:E.id,highlighted_text:_.selection.text,note_content:e};N(t),S({stage:"hidden"})},onDelete:z,onClose:()=>S({stage:"hidden"}),className:"annotation-popup-container"}),(0,h.jsxs)("div",{className:"animate-fade-in max-w-4xl mx-auto space-y-6",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsxs)(c.A,{variant:"secondary",onClick:()=>C("/articles"),children:[(0,h.jsx)(d.A6,{})," M\u0259qal\u0259l\u0259r siyah\u0131s\u0131na qay\u0131t"]}),R?(0,h.jsxs)("span",{className:"flex items-center font-semibold text-green-600",children:[(0,h.jsx)(d.C1,{className:"w-6 h-6 mr-2"})," Oxunub"]}):(0,h.jsx)(c.A,{onClick:()=>p(E.id),children:"Oxunmu\u015f kimi i\u015far\u0259l\u0259"})]}),(0,h.jsxs)(r.A,{children:[(0,h.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:E.title}),(0,h.jsx)("div",{ref:k,className:"article-content",dangerouslySetInnerHTML:{__html:M}}),(0,h.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,h.jsx)(m.A,{targetId:E.id,targetType:"article",profile:y,fetchComments:b,postComment:j,deleteComment:v})})]}),E.quizzes&&E.quizzes.length>0&&(0,h.jsxs)(r.A,{children:[(0,h.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"M\xf6vzuya aid testl\u0259r"}),(0,h.jsx)("div",{className:"space-y-3",children:E.quizzes.map(e=>(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h3",{className:"font-semibold text-lg",children:e.title}),(0,h.jsxs)("p",{className:"text-sm text-gray-500",children:[e.questions.length," sual"]})]}),(0,h.jsxs)(c.A,{onClick:()=>u(e.id),children:[(0,h.jsx)(d.ud,{})," Test\u0259 Ba\u015fla"]})]},e.id))})]})]})]})}}}]);
//# sourceMappingURL=420.52570df5.chunk.js.map