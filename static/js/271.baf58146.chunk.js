"use strict";(self.webpackChunkquiztest=self.webpackChunkquiztest||[]).push([[271],{7271:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var r=t(9379),a=t(5043),n=t(5475),l=t(3216),c=t(8132),i=t(4450),o=t(1425),d=t(3918),x=t(6058),m=t(7304),u=t(579);m.t1.register(m.PP,m.kc,m.E8,m.hE,m.m_,m.s$);const h=(e,s)=>{if(void 0===s||null===s)return!1;if(!e||!e.type)return!1;if("open"===e.type)return(null===s||void 0===s?void 0:s.score)>0;if("single"===e.type)return s===e.options[e.correctAnswers[0]];if("multiple"===e.type){const t=e.correctAnswers.map(s=>e.options[s]).sort(),r=s?[...s].sort():[];return JSON.stringify(t)===JSON.stringify(r)}return"textInput"===e.type?s&&e.correctAnswers[0].trim().toLowerCase()===s.trim().toLowerCase():"trueFalse"===e.type?s===e.correctAnswer:"ordering"===e.type&&JSON.stringify(s)===JSON.stringify(e.orderItems)},g=e=>{let{isOpen:s,onClose:t,question:l,results:c}=e;const i=(0,a.useMemo)(()=>{if(!l||!c)return{correct:[],incorrect:[]};const e=[],s=[];return c.forEach(t=>{const a={id:t.user_id,name:"".concat(t.userName," ").concat(t.userSurname)},n=t.userAnswers[l.id];var c;h(l,n)?e.push(a):s.push((0,r.A)((0,r.A)({},a),{},{answer:(c=n,null===c||void 0===c?"Cavab yoxdur":Array.isArray(c)?c.join(", "):"object"===typeof c?c.answer||"N/A":String(c))}))}),{correct:e,incorrect:s}},[l,c]);return s?(0,u.jsx)(o.A,{isOpen:s,onClose:t,title:'Suala cavab ver\u0259nl\u0259r: "'.concat(l.text,'"'),size:"lg",children:(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h4",{className:"font-bold text-green-600 mb-2 flex items-center gap-2",children:[(0,u.jsx)(d.C1,{})," D\xfczg\xfcn cavab ver\u0259nl\u0259r (",i.correct.length,")"]}),(0,u.jsx)("div",{className:"max-h-64 overflow-y-auto bg-green-50 p-3 rounded-lg",children:i.correct.length>0?(0,u.jsx)("ul",{className:"space-y-2",children:i.correct.map(e=>(0,u.jsx)("li",{children:(0,u.jsx)(n.N_,{to:"/student/".concat(e.id),className:"text-blue-600 hover:underline",children:e.name})},e.id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Yoxdur"})})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("h4",{className:"font-bold text-red-600 mb-2 flex items-center gap-2",children:[(0,u.jsx)(d.qh,{})," S\u0259hv cavab ver\u0259nl\u0259r (",i.incorrect.length,")"]}),(0,u.jsx)("div",{className:"max-h-64 overflow-y-auto bg-red-50 p-3 rounded-lg",children:i.incorrect.length>0?(0,u.jsx)("ul",{className:"space-y-2",children:i.incorrect.map(e=>(0,u.jsxs)("li",{children:[(0,u.jsx)(n.N_,{to:"/student/".concat(e.id),className:"text-blue-600 hover:underline",children:e.name}),(0,u.jsxs)("p",{className:"text-xs text-gray-600 pl-2 border-l-2 border-red-200 ml-2 mt-1",children:["Cavab: ",(0,u.jsx)("span",{className:"font-medium text-red-700",children:e.answer})]})]},e.id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Yoxdur"})})]})]})}):null},p=e=>{let{quizzes:s,results:t,allUsers:o}=e;const{quizId:m}=(0,l.g)(),[p,j]=(0,a.useState)(null),N=(0,a.useMemo)(()=>s.find(e=>e.id===Number(m)),[s,m]),f=(0,a.useMemo)(()=>t.filter(e=>e.quizId===Number(m)&&"pending_review"!==e.status),[t,m]),b=(0,a.useMemo)(()=>{if(!N||0===f.length)return null;const e=f.length,s=f.reduce((e,s)=>e+s.percentage,0)/e,t=Math.max(...f.map(e=>e.percentage)),a=Math.min(...f.map(e=>e.percentage)),n=Array(10).fill(0);f.forEach(e=>{const s=Math.floor(e.percentage/10);10===s?n[9]++:n[s]++});const l=(N.questions||[]).map(s=>{let t=0;return f.forEach(e=>{h(s,e.userAnswers[s.id])&&t++}),(0,r.A)((0,r.A)({},s),{},{correctPercentage:t/e*100})});return{totalAttempts:e,averageScore:s,highestScore:t,lowestScore:a,scoreDistribution:n,questionAnalysis:l}},[N,f]),y=(0,a.useMemo)(()=>{if(!f||!o)return[];const e={};return f.forEach(s=>{(!e[s.user_id]||s.score>e[s.user_id].score)&&(e[s.user_id]={score:s.score,percentage:s.percentage,user_id:s.user_id})}),Object.values(e).sort((e,s)=>s.score-e.score).slice(0,10).map(e=>{const s=o.find(s=>s.id===e.user_id);return(0,r.A)((0,r.A)({},e),{},{name:s?"".concat(s.first_name||""," ").concat(s.last_name||"").trim():"Nam\u0259lum istifad\u0259\xe7i"})})},[f,o]);if(!N)return(0,u.jsx)(c.A,{children:(0,u.jsx)("p",{className:"text-center",children:"Test tap\u0131lmad\u0131."})});if(!b)return(0,u.jsx)(c.A,{children:(0,u.jsx)("p",{className:"text-center",children:"Bu test \xfc\xe7\xfcn he\xe7 bir n\u0259tic\u0259 tap\u0131lmad\u0131."})});const v={labels:["0-9%","10-19%","20-29%","30-39%","40-49%","50-59%","60-69%","70-79%","80-89%","90-100%"],datasets:[{label:"T\u0259l\u0259b\u0259 say\u0131",data:b.scoreDistribution,backgroundColor:"rgba(249, 115, 22, 0.6)",borderColor:"rgba(249, 115, 22, 1)",borderWidth:1}]};return(0,u.jsxs)("div",{className:"animate-fade-in space-y-6",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Test Analizi"}),(0,u.jsx)("p",{className:"text-lg text-gray-600",children:N.title})]}),(0,u.jsx)(n.N_,{to:"/stats",children:(0,u.jsxs)(i.A,{variant:"secondary",children:[(0,u.jsx)(d.A6,{})," Statistikaya qay\u0131t"]})})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,u.jsxs)(c.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"C\u0259hdl\u0259r"}),(0,u.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:b.totalAttempts})]}),(0,u.jsxs)(c.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"Orta N\u0259tic\u0259"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-blue-600",children:[b.averageScore.toFixed(1),"%"]})]}),(0,u.jsxs)(c.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"\u018fn Y\xfcks\u0259k"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:[b.highestScore,"%"]})]}),(0,u.jsxs)(c.A,{className:"text-center",children:[(0,u.jsx)("h3",{className:"font-semibold",children:"\u018fn A\u015fa\u011f\u0131"}),(0,u.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:[b.lowestScore,"%"]})]})]}),(0,u.jsxs)(c.A,{children:[(0,u.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,u.jsx)(d.OR,{})," Bu Test \xfczr\u0259 Liderl\u0259r"]}),y.length>0?(0,u.jsx)("ol",{className:"space-y-2",children:y.map((e,s)=>(0,u.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-gray-50",children:[(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)("span",{className:"font-bold text-gray-400 w-6 text-center",children:s+1}),(0,u.jsxs)("span",{className:"flex items-center gap-2",children:[0===s?(0,u.jsx)(d.b8,{}):1===s?(0,u.jsx)(d.SZ,{}):2===s?(0,u.jsx)(d.BC,{}):(0,u.jsx)(d.OR,{className:"w-5 h-5 text-gray-400"}),(0,u.jsx)(n.N_,{to:"/student/".concat(e.user_id),className:"font-semibold text-blue-600 hover:underline",children:e.name})]})]}),(0,u.jsxs)("span",{className:"font-bold text-orange-500",children:[e.score," bal (",e.percentage,"%)"]})]},e.user_id))}):(0,u.jsx)("p",{className:"text-gray-500",children:"Bu test \xfc\xe7\xfcn reytinq m\u0259lumat\u0131 yoxdur."})]}),(0,u.jsxs)(c.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"N\u0259tic\u0259l\u0259rin Paylanmas\u0131"}),(0,u.jsx)("div",{className:"h-80",children:(0,u.jsx)(x.yP,{data:v,options:{maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})]}),(0,u.jsxs)(c.A,{children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Suallar\u0131n Analizi"}),(0,u.jsx)("div",{className:"space-y-2",children:b.questionAnalysis.map((e,s)=>(0,u.jsxs)("button",{onClick:()=>j(e),className:"w-full text-left p-4 rounded-lg bg-gray-50 hover:bg-orange-50 transition",children:[(0,u.jsxs)("p",{className:"font-semibold",children:[s+1,". ",e.text]}),(0,u.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,u.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4",children:(0,u.jsx)("div",{className:"h-4 rounded-full transition-all duration-500",style:{width:"".concat(e.correctPercentage,"%"),backgroundColor:e.correctPercentage>60?"#22C55E":e.correctPercentage>30?"#F59E0B":"#EF4444"}})}),(0,u.jsxs)("span",{className:"font-bold text-sm w-16 text-right",style:{color:e.correctPercentage>60?"#16A34A":e.correctPercentage>30?"#D97706":"#DC2626"},children:[e.correctPercentage.toFixed(1),"%"]})]}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"d\xfczg\xfcn cavab verdi"})]},e.id))})]}),(0,u.jsx)(g,{isOpen:!!p,onClose:()=>j(null),question:p,results:f})]})}},8132:(e,s,t)=>{t.d(s,{A:()=>a});t(5043);var r=t(579);const a=e=>{let{children:s,className:t=""}=e;return(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ".concat(t),children:s})}}}]);
//# sourceMappingURL=271.baf58146.chunk.js.map