"use strict";(self.webpackChunkquiztest=self.webpackChunkquiztest||[]).push([[213],{3213:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var r=s(9379),a=s(5043),l=s(5475),i=s(8132),n=s(3918),c=s(579);const o=e=>{let{title:t,value:s,icon:r,subtext:a}=e;return(0,c.jsxs)(i.A,{className:"text-center",children:[(0,c.jsx)("div",{className:"mx-auto text-orange-500 mb-2",children:r}),(0,c.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:s}),(0,c.jsx)("h3",{className:"font-semibold text-gray-600",children:t}),a&&(0,c.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:a})]})},d=e=>{let{studentGroups:t,allUsers:s,results:d,courses:u,quizzes:m,userCourseCompletions:x}=e;const[h,g]=(0,a.useState)(""),p=(0,a.useMemo)(()=>{if(!h)return null;const e=t.find(e=>e.id===Number(h));if(!e)return null;const a=new Set((e.members||[]).map(e=>e.user_id));if(0===a.size)return{groupName:e.name,memberCount:0};const l=s.filter(e=>a.has(e.id)),i=d.filter(e=>a.has(e.user_id)&&"pending_review"!==e.status),n=(x||[]).filter(e=>a.has(e.user_id)),c=i.reduce((e,t)=>e+t.percentage,0),o=i.length>0?(c/i.length).toFixed(1):0,g=a.size*u.filter(e=>e.is_published).length,p=g>0?(n.length/g*100).toFixed(1):0,j=new Date;j.setDate(j.getDate()-7);const b=l.map(e=>{const t=i.filter(t=>t.user_id===e.id),s=t.length>0?t.reduce((e,t)=>e+t.percentage,0)/t.length:0;return(0,r.A)((0,r.A)({},e),{},{average:s})}).filter(e=>e.average<50||!e.last_login||new Date(e.last_login)<j),f={};i.forEach(e=>{const t=m.find(t=>t.id===e.quizId);t&&e.questionOrder.forEach(s=>{const r=(t.questions||[]).find(e=>e.id===s.id);r&&(f[r.id]||(f[r.id]={text:r.text,correct:0,incorrect:0,quizTitle:t.title}),((e,t)=>{if(void 0===t||null===t)return!1;if(!e||!e.type)return!1;if("open"===e.type)return(null===t||void 0===t?void 0:t.score)>0;if("single"===e.type)return t===e.options[e.correctAnswers[0]];if("multiple"===e.type){const s=e.correctAnswers.map(t=>e.options[t]).sort(),r=t?[...t].sort():[];return JSON.stringify(s)===JSON.stringify(r)}return"textInput"===e.type?t&&e.correctAnswers[0].trim().toLowerCase()===t.trim().toLowerCase():"trueFalse"===e.type?t===e.correctAnswer:"ordering"===e.type&&JSON.stringify(t)===JSON.stringify(e.orderItems)})(r,e.userAnswers[r.id])?f[r.id].correct++:f[r.id].incorrect++)})});const N=Object.values(f).map(e=>(0,r.A)((0,r.A)({},e),{},{total:e.correct+e.incorrect,correctRate:e.correct/(e.correct+e.incorrect)*100})).filter(e=>e.total>0),v=[...N].sort((e,t)=>e.correctRate-t.correctRate).slice(0,5),y=[...N].sort((e,t)=>t.correctRate-e.correctRate).slice(0,5);return{groupName:e.name,memberCount:a.size,averageScore:o,courseCompletionPercentage:p,atRiskStudents:b,hardestQuestions:v,easiestQuestions:y}},[h,t,s,d,u,m,x]);return(0,c.jsxs)("div",{className:"animate-fade-in space-y-6",children:[(0,c.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Qrup Analizi"}),(0,c.jsx)(i.A,{children:(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{htmlFor:"group-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"T\u0259hlil \xfc\xe7\xfcn qrupu se\xe7in"}),(0,c.jsxs)("select",{id:"group-select",value:h,onChange:e=>g(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-white focus:ring-orange-500 focus:border-orange-500",children:[(0,c.jsx)("option",{value:"",disabled:!0,children:"Qrup se\xe7in..."}),t.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name},e.id))]})]})}),p?(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("h2",{className:"text-xl font-bold",children:["Statistika: ",p.groupName," (",p.memberCount," \xfczv)"]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,c.jsx)(o,{title:"Testl\u0259r \xfczr\u0259 orta bal",value:"".concat(p.averageScore,"%"),icon:(0,c.jsx)(n.r9,{})}),(0,c.jsx)(o,{title:"Kurslar\u0131 tamamlama",value:"".concat(p.courseCompletionPercentage,"%"),icon:(0,c.jsx)(n.tl,{}),subtext:"(b\xfct\xfcn kurslar \xfczr\u0259)"}),(0,c.jsx)(o,{title:"Risk qrupunda olanlar",value:p.atRiskStudents.length,icon:(0,c.jsx)(n.Y3,{}),subtext:"(z\u0259if n\u0259tic\u0259 v\u0259 ya aktivlik)"})]}),p.atRiskStudents.length>0&&(0,c.jsxs)(i.A,{children:[(0,c.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Risq Qrupundak\u0131 T\u0259l\u0259b\u0259l\u0259r"}),(0,c.jsx)("ul",{className:"divide-y divide-gray-200",children:p.atRiskStudents.map(e=>(0,c.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[(0,c.jsxs)(l.N_,{to:"/student/".concat(e.id),className:"text-blue-600 hover:underline font-semibold",children:[e.first_name," ",e.last_name]}),(0,c.jsxs)("div",{className:"text-right",children:[(0,c.jsxs)("p",{className:"text-sm text-red-600",children:["Orta bal: ",e.average.toFixed(1),"%"]}),(0,c.jsxs)("p",{className:"text-xs text-gray-500",children:["Son aktivlik: ",e.last_login?new Date(e.last_login).toLocaleDateString():"M\u0259lum deyil"]})]})]},e.id))})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,c.jsxs)(i.A,{children:[(0,c.jsx)("h3",{className:"font-bold text-lg mb-3",children:"\u018fn \xc7\u0259tin Suallar"}),(0,c.jsx)("ul",{className:"space-y-2",children:p.hardestQuestions.map(e=>(0,c.jsxs)("li",{className:"text-sm p-2 bg-red-50 rounded-md",children:[(0,c.jsx)("p",{className:"font-semibold truncate",children:e.text}),(0,c.jsxs)("p",{className:"text-red-700",children:["D\xfczg\xfcn cavab: ",e.correctRate.toFixed(1),"% (",e.quizTitle,")"]})]},e.text))})]}),(0,c.jsxs)(i.A,{children:[(0,c.jsx)("h3",{className:"font-bold text-lg mb-3",children:"\u018fn Asan Suallar"}),(0,c.jsx)("ul",{className:"space-y-2",children:p.easiestQuestions.map(e=>(0,c.jsxs)("li",{className:"text-sm p-2 bg-green-50 rounded-md",children:[(0,c.jsx)("p",{className:"font-semibold truncate",children:e.text}),(0,c.jsxs)("p",{className:"text-green-700",children:["D\xfczg\xfcn cavab: ",e.correctRate.toFixed(1),"% (",e.quizTitle,")"]})]},e.text))})]})]})]}):h&&(0,c.jsx)(i.A,{className:"text-center py-12",children:(0,c.jsx)("p",{className:"text-gray-500",children:"Bu qrup \xfc\xe7\xfcn data tap\u0131lmad\u0131."})})]})}},8132:(e,t,s)=>{s.d(t,{A:()=>a});s(5043);var r=s(579);const a=e=>{let{children:t,className:s=""}=e;return(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ".concat(s),children:t})}}}]);
//# sourceMappingURL=213.5210184f.chunk.js.map